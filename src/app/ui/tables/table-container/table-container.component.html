<div class="w-full">
  <div class="w-full flex justify-center" *ngIf="false">
    <app-switch-simple [options]="switchOptionsTable" [activeValue]="switchOptionActive"
                       (changed)="changeTypeView($event)"></app-switch-simple>
  </div>
  <ng-container *ngIf="switchOptionActive == 'table'">
    <div class="hidden lg:block w-full rounded-md animation-opacity">
      <app-table-generic
        tableBodyIdentifier="id"
        [tableName]="tableName"
        [tableData]="tableData"
        [tablePrincipalTitle]="tablePrincipalTitle"
        [tablePrincipalDescription]="tablePrincipalDescription"
        [tablePrincipalIcon]="tablePrincipalIcon"
        [tableColumnConfig]="tableColumnConfig"
        [tableQuicklyActionsConfig]="tableQuicklyActionsConfig"
        [tableHeaderActionsConfig]="tableHeaderActionsConfig"
        [tableFieldActionsConfig]="tableFieldActionsConfig"
        [searchActions]="searchActions"
        [quicklyActions]="quicklyActions"
        [multipleActions]="multipleActions"
        [headerActions]="headerActions"
        [exportAction]="exportAction"
        [tableLimit]="tableLimit"
        [tableLimitList]="tableLimitList"
        [tablePagination]="tablePagination"
        [switchOptionActive]="switchOptionActive"
        [switchOptionsTable]="switchOptionsTable"
        (eventViewChange)="changeTypeView($event)"
        (eventLimitChange)="eventChangeLimit($event)"
        (tableEvents)="listenEventFields($event)"
      >
      </app-table-generic>
    </div>
    <div class="lg:hidden block w-full">
      <app-table-mobile-generic
        [isResponsive]="true"
        [configPrinciplesRow]="configPrinciplesRow"
        [tableData]="tableData"
        [tableColumnConfig]="tableColumnConfig"
        [tableHeaderActionsConfig]="tableHeaderActionsConfig"
        [tableQuicklyActionsConfig]="tableQuicklyActionsConfig"
        [tableConfigFieldActions]="tableFieldActionsConfig"
        [tableLimit]="tableLimit"
        [tableLimitList]="tableLimitList"
        [validActions]="multipleActions"
        [searchActions]="searchActions"
        [tablePagination]="tablePagination"
        (eventLimitChange)="eventChangeLimit($event)"
        (tableEvents)="listenEventFields($event)"
      >
      </app-table-mobile-generic>
    </div>
  </ng-container>
  <ng-container *ngIf="switchOptionActive == 'cards'">
    <div class="rounded-md shadow-md border-btw border animation-opacity bg-btw-secondary mb-3 overflow-hidden">
      <ng-template [ngTemplateOutlet]="headerInfoTable"></ng-template>
      <ng-template [ngTemplateOutlet]="headerSearchTable"></ng-template>
      <ng-container *ngIf="tableData.length == 0">
        <app-empty-table></app-empty-table>
      </ng-container>
    </div>
    <div class="w-full flex flex-wrap animation-opacity gap-2 justify-center sm:justify-start">
      <ng-container *ngFor="let dataRow of tableData">
        <app-card-info
          [tableConfig]="tableColumnConfig"
          [tablePrincipalIcon]="tablePrincipalIcon"
          [tableFieldActionsConfig]="tableFieldActionsConfig"
          [tableQuicklyActionsConfig]="tableQuicklyActionsConfig"
          [dataCard]="dataRow"
          (eventCard)="eventRow($event.data, $event.eventName)"
        ></app-card-info>
      </ng-container>
    </div>
  </ng-container>
  <ng-container *ngIf="tablePagination">
    <ng-template [ngTemplateOutlet]="paginationTable"></ng-template>
  </ng-container>
</div>

<ng-template #headerInfoTable>
  <div class="grid grid-cols-2 h-14">
    <div class="flex flex-wrap justify-start gap-2 px-2 col-span-1">
      <div class="grid gap-2" style="grid-template-columns: 50px 1fr">
        <div class="h-full w-full flex justify-center items-center">
          <div
            class="h-10 w-10 bg-btw-primary flex justify-center items-center border border-btw text-btw text-xs rounded-md">
            <app-icon-material [nameIcon]="tablePrincipalIcon" sizeIcon="large"></app-icon-material>
          </div>
        </div>
        <div class="flex w-full justify-center items-start flex-col">
          <p class="text-btw font-medium text-sm">{{ tablePrincipalTitle }}</p>
          <p class="text-btw font-light text-xs">{{ tablePrincipalDescription }}</p>
        </div>
      </div>
    </div>
    <div class="flex flex-wrap items-center overflow-x-auto justify-end gap-2 px-2 col-span-1">
      <ng-container *ngIf="headerActions">
        <ng-container *ngFor="let action of tableHeaderActionsConfig">
          <button
            class="rounded-md flex gap-2
              h-10 p-2 justify-center
              border-btw border items-center
              min-w-fit text-xs
              select-none
              cursor-pointer"
            [ngStyle]="{
            'background-color': action.background || 'var(--color-bg)',
            'color': action.color || '#FFF'
            }"
            (click)="eventRow('', action.nameEvent)">
            <app-icon-material [nameIcon]="action.icon" sizeIcon="medium"></app-icon-material>
            {{ action.label }}
          </button>
        </ng-container>
      </ng-container>
      <app-switch-simple [options]="switchOptionsTable" [activeValue]="switchOptionActive"
                         (changed)="changeTypeView($event)"></app-switch-simple>
    </div>
  </div>
  <hr class="text-btw">
</ng-template>

<ng-template #headerSearchTable>
  <ng-container [formGroup]="tableFormQueries">
    <div class="grid grid-cols-2 max-w-full overflow-hidden h-14 relative">
      <div
        class="flex gap-2 items-center text-btw bg-btw-secondary select-none border-r-btw w-full col-span-1 px-4">
        <span class="material-symbols-outlined">search</span>
        <input type="text" placeholder="Buscar..." formControlName="search"
               class="h-full hover:outline-0 hover:active:outline-0 focus:outline-0 bg-transparent w-max">
      </div>
      <div class="flex flex-wrap justify-end gap-2 w-full col-span-1 overflow-x-auto items-center px-4">
        <ng-container *ngIf="filterAction">
          <button
            class="rounded-md flex gap-2
            border-btw border py-2 px-3 items-center
            text-btw bg-btw-secondary select-none cursor-pointer">
            <span class="material-symbols-outlined">filter_alt</span>
            <p class="text-xs">Filtros</p>
          </button>
        </ng-container>
        <ng-container *ngIf="exportAction">
          <button
            class="rounded-md flex gap-2
            border-btw border p-3 items-center
            text-btw bg-btw-secondary select-none cursor-pointer">
            <span class="material-symbols-outlined">publish</span>
            <p class="text-xs">Exportar Datos</p>
          </button>
        </ng-container>
        <button
          *ngIf="false"
          class="rounded-md flex gap-2
          h-10 p-2 justify-center
          border-btw border items-center
          min-w-fit
          text-btw bg-btw-secondary select-none cursor-pointer"
          (click)="openModalEditColumns()">
          <span class="material-symbols-outlined">tune</span>
        </button>
      </div>
    </div>
  </ng-container>
</ng-template>

<ng-template #paginationTable>
  <app-pagination
    [tableLimit]="tableLimit"
    [tableLimitList]="tableLimitList"
    [pagination]="tablePagination"
    (eventChangeLimit)="changeTableLimit($event)"
  ></app-pagination>
</ng-template>
